"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6260],{6260:(P,_,p)=>{p.r(_),p.d(_,{HomePageModule:()=>C});var h=p(6814),s=p(6761),g=p(95),m=p(6958),u=p(5861),l=p(8702),e=p(6689),f=p(2014);function v(r,c){if(1&r){const i=e.EpF();e.TgZ(0,"ion-col",11)(1,"ion-card",12),e._UZ(2,"img",13),e.TgZ(3,"ion-card-header")(4,"ion-card-title")(5,"b"),e._uU(6),e.qZA()(),e.TgZ(7,"ion-card-subtitle"),e._uU(8,"Director: "),e.TgZ(9,"b"),e._uU(10),e.qZA()(),e.TgZ(11,"ion-card-subtitle"),e._uU(12,"Producer: "),e.TgZ(13,"b"),e._uU(14),e.qZA()(),e.TgZ(15,"ion-card-subtitle"),e._uU(16,"Protagonists: "),e.TgZ(17,"b"),e._uU(18),e.qZA()()(),e.TgZ(19,"ion-card-content")(20,"p",14),e._uU(21),e.qZA()(),e.TgZ(22,"ion-button",15),e.NdJ("click",function(){const n=e.CHM(i).$implicit,a=e.oxw();return e.KtG(a.openCreateEditMovie("edit",n))}),e._uU(23,"Edit"),e.qZA(),e.TgZ(24,"ion-button",16),e.NdJ("click",function(){const n=e.CHM(i).$implicit,a=e.oxw();return e.KtG(a.deleteMovie(n._id))}),e._uU(25,"Delete"),e.qZA()()()}if(2&r){const i=c.$implicit;e.xp6(2),e.s9C("src",i.cover,e.LSH),e.xp6(4),e.Oqu(i.title),e.xp6(4),e.Oqu(i.director),e.xp6(4),e.Oqu(i.producer),e.xp6(4),e.Oqu(i.protagonists),e.xp6(3),e.Oqu(i.description)}}function M(r,c){1&r&&e._UZ(0,"ion-icon",27)}function x(r,c){1&r&&e._UZ(0,"ion-spinner",28)}function T(r,c){if(1&r){const i=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e._uU(3),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.isModalOpen=!1)}),e._uU(6,"Close"),e.qZA()()()(),e.TgZ(7,"ion-content",17)(8,"form",17)(9,"div",18)(10,"ion-input",19),e.NdJ("ngModelChange",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.title=o)}),e.qZA()(),e.TgZ(11,"div",18)(12,"ion-input",20),e.NdJ("ngModelChange",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.description=o)}),e.qZA()(),e.TgZ(13,"div",18)(14,"ion-input",21),e.NdJ("ngModelChange",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.producer=o)}),e.qZA()(),e.TgZ(15,"div",18)(16,"ion-input",22),e.NdJ("ngModelChange",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.director=o)}),e.qZA()(),e.TgZ(17,"div",18)(18,"ion-input",23),e.NdJ("ngModelChange",function(o){e.CHM(i);const n=e.oxw();return e.KtG(n.protagonists=o)}),e.qZA()(),e.TgZ(19,"div",18)(20,"ion-button",24),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.createEditMovie())}),e._uU(21),e.YNc(22,M,1,0,"ion-icon",25),e.YNc(23,x,1,0,"ion-spinner",26),e.qZA()()()()}if(2&r){const i=e.oxw();e.xp6(3),e.hij("",i.titleModal," movie"),e.xp6(7),e.Q6J("ngModel",i.title),e.xp6(2),e.Q6J("ngModel",i.description),e.xp6(2),e.Q6J("ngModel",i.producer),e.xp6(2),e.Q6J("ngModel",i.director),e.xp6(2),e.Q6J("ngModel",i.protagonists),e.xp6(2),e.Q6J("disabled",i.showSpinner),e.xp6(1),e.hij("",i.titleButton," "),e.xp6(1),e.Q6J("ngIf",!i.showSpinner),e.xp6(1),e.Q6J("ngIf",i.showSpinner)}}const Z=[{path:"",component:(()=>{var r;class c{constructor(t,o,n,a){this.toastController=t,this.alertController=o,this.router=n,this.storage=a,this.showSpinner=!1,this.movies=[],this.query="",this.isModalOpen=!1,this.title="",this.description="",this.producer="",this.director="",this.protagonists="",this.isCreate=!1,this.titleModal="",this.titleButton="",this.token=""}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,u.Z)(function*(){t.token=yield t.storage.get("token"),console.log(t.token),t.token||t.router.navigate(["/login"],{replaceUrl:!0}),t.getMovies()})()}getMovies(){var t=this;axios.get(l.v.hostname+":"+l.v.PORT+l.v.routeMovies+"/all",{headers:{"Content-Type":"application/json","Auth-Token":this.token}}).then(function(){var o=(0,u.Z)(function*(n){console.log(n),200==n.status&&(t.movies=[...n.data.movies])});return function(n){return o.apply(this,arguments)}}()).catch(function(){var o=(0,u.Z)(function*(n){console.log(n),t.toastController.create({message:n.response.data.error,position:"bottom",duration:4e3,color:"dark"}).then(a=>{a.present()}),("tar"==n.response.data.type||"adtiae"==n.response.data.type)&&(yield t.storage.remove("token"),t.router.navigate(["/login"],{replaceUrl:!0}))});return function(n){return o.apply(this,arguments)}}())}getMoviesByTitle(){var t=this;""==this.query?this.getMovies():axios.get(l.v.hostname+":"+l.v.PORT+l.v.routeMovies+"/search/"+this.query,{headers:{"Content-Type":"application/json","Auth-Token":this.token}}).then(function(){var o=(0,u.Z)(function*(n){console.log(n),200==n.status&&(t.movies=[...n.data.movies])});return function(n){return o.apply(this,arguments)}}()).catch(function(){var o=(0,u.Z)(function*(n){console.log(n),t.toastController.create({message:n.response.data.error,position:"bottom",duration:4e3,color:"dark"}).then(a=>{a.present()}),("tar"==n.response.data.type||"adtiae"==n.response.data.type)&&(yield t.storage.remove("token"),t.router.navigate(["/login"],{replaceUrl:!0}))});return function(n){return o.apply(this,arguments)}}())}openCreateEditMovie(t,o){this.isModalOpen=!0,"edit"==t?(this.isCreate=!1,this.titleModal="Edit",this.titleButton="Update",this.title=o.title,this.description=o.description,this.producer=o.producer,this.director=o.director,this.protagonists=o.protagonists,this.idMovie=o._id):(this.isCreate=!0,this.titleModal="Create",this.titleButton=this.titleModal,this.title="",this.description="",this.producer="",this.director="",this.protagonists="",this.idMovie="")}createEditMovie(){var t=this;let o;this.showSpinner=!0,o=this.isCreate?axios.post(l.v.hostname+":"+l.v.PORT+l.v.routeMovies+"/create",{title:this.title,description:this.description,producer:this.producer,director:this.director,protagonists:this.protagonists},{headers:{"Content-Type":"application/json","Auth-Token":this.token}}):axios.put(l.v.hostname+":"+l.v.PORT+l.v.routeMovies+"/update/"+this.idMovie,{title:this.title,description:this.description,producer:this.producer,director:this.director,protagonists:this.protagonists},{headers:{"Content-Type":"application/json","Auth-Token":this.token}}),o.then(function(){var n=(0,u.Z)(function*(a){console.log(a),200==a.status&&(t.isModalOpen=!1,t.title="",t.description="",t.producer="",t.director="",t.protagonists="",t.idMovie="",t.showSpinner=!1,""==t.query?t.getMovies():t.getMoviesByTitle())});return function(a){return n.apply(this,arguments)}}()).catch(function(){var n=(0,u.Z)(function*(a){console.log(a),t.showSpinner=!1,t.toastController.create({message:a.response.data.error,position:"bottom",duration:4e3,color:"dark"}).then(d=>{d.present()}),("tar"==a.response.data.type||"adtiae"==a.response.data.type)&&(yield t.storage.remove("token"),t.router.navigate(["/login"],{replaceUrl:!0}))});return function(a){return n.apply(this,arguments)}}())}deleteMovie(t){var o=this;return(0,u.Z)(function*(){yield(yield o.alertController.create({header:"Delete movie",message:"Are you sure to delete the movie?",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Alert canceled")}},{text:"OK",role:"confirm",handler:()=>{console.log("Alert confirmed"),axios.delete(l.v.hostname+":"+l.v.PORT+l.v.routeMovies+"/delete/"+t,{headers:{"Content-Type":"application/json","Auth-Token":o.token}}).then(function(){var a=(0,u.Z)(function*(d){console.log(d),200==d.status&&(""==o.query?o.getMovies():o.getMoviesByTitle())});return function(d){return a.apply(this,arguments)}}()).catch(function(){var a=(0,u.Z)(function*(d){console.log(d),o.toastController.create({message:d.response.data.error,position:"bottom",duration:4e3,color:"dark"}).then(b=>{b.present()}),("tar"==d.response.data.type||"adtiae"==d.response.data.type)&&(yield o.storage.remove("token"),o.router.navigate(["/login"],{replaceUrl:!0}))});return function(d){return a.apply(this,arguments)}}())}}]})).present()})()}logOut(){var t=this;return(0,u.Z)(function*(){var n;yield(yield t.alertController.create({header:"Log Out",message:"Are you sure you want to log out?",buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Alert canceled")}},{text:"OK",role:"confirm",handler:(n=(0,u.Z)(function*(){console.log("Alert confirmed"),yield t.storage.remove("token"),t.router.navigate(["/login"],{replaceUrl:!0})}),function(){return n.apply(this,arguments)})}]})).present()})()}}return(r=c).\u0275fac=function(t){return new(t||r)(e.Y36(s.yF),e.Y36(s.Br),e.Y36(m.F0),e.Y36(f.K))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-home"]],decls:16,vars:7,consts:[[3,"translucent"],["slot","end"],[3,"click"],["slot","icon-only","name","log-out-outline"],[3,"fullscreen"],["placeholder","Search movies by title",3,"debounce","ngModel","ngModelChange","ionInput"],[1,"ion-padding","ion-text-center"],["sizeMd","3",4,"ngFor","ngForOf"],["slot","fixed","vertical","bottom","horizontal","center"],["name","add"],[3,"isOpen","backdropDismiss"],["sizeMd","3"],[1,"ion-padding-bottom"],["alt","cover-movie",3,"src"],[1,"ion-text-nowrap",2,"text-overflow","ellipsis","overflow","hidden"],["color","warning","mode","ios",3,"click"],["color","danger","mode","ios",3,"click"],[1,"ion-padding"],[1,"ion-margin-vertical"],["type","text","label","Title","labelPlacement","stacked","name","title","placeholder","Enter title","required","true",1,"ion-margin-vertical",3,"ngModel","ngModelChange"],["type","text","label","Description","labelPlacement","stacked","name","description","placeholder","Enter description","required","true",1,"ion-margin-vertical",3,"ngModel","ngModelChange"],["type","text","label","Producer","labelPlacement","stacked","name","producer","placeholder","Enter producer","required","true",1,"ion-margin-vertical",3,"ngModel","ngModelChange"],["type","text","label","Director","labelPlacement","stacked","name","director","placeholder","Enter director","required","true",1,"ion-margin-vertical",3,"ngModel","ngModelChange"],["type","text","label","Protagonists","labelPlacement","stacked","name","protagonists","placeholder","Enter protagonists","required","true",1,"ion-margin-vertical",3,"ngModel","ngModelChange"],["mode","ios","expand","block","color","primary",1,"ion-margin-top",3,"disabled","click"],["name","arrow-forward","slot","end",4,"ngIf"],["name","lines",4,"ngIf"],["name","arrow-forward","slot","end"],["name","lines"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Movies "),e.qZA(),e.TgZ(4,"ion-buttons",1)(5,"ion-button",2),e.NdJ("click",function(){return o.logOut()}),e._UZ(6,"ion-icon",3),e.qZA()()()(),e.TgZ(7,"ion-content",4)(8,"ion-searchbar",5),e.NdJ("ngModelChange",function(a){return o.query=a})("ionInput",function(){return o.getMoviesByTitle()}),e.qZA(),e.TgZ(9,"ion-row",6),e.YNc(10,v,26,6,"ion-col",7),e.qZA(),e.TgZ(11,"ion-fab",8)(12,"ion-fab-button",2),e.NdJ("click",function(){return o.openCreateEditMovie("create",null)}),e._UZ(13,"ion-icon",9),e.qZA()(),e.TgZ(14,"ion-modal",10),e.YNc(15,T,24,10,"ng-template"),e.qZA()()),2&t&&(e.Q6J("translucent",!0),e.xp6(7),e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("debounce",1e3)("ngModel",o.query),e.xp6(2),e.Q6J("ngForOf",o.movies),e.xp6(4),e.Q6J("isOpen",o.isModalOpen)("backdropDismiss",!1))},dependencies:[h.sg,h.O5,g._Y,g.JJ,g.JL,g.Q7,g.On,g.F,s.YG,s.Sm,s.PM,s.FN,s.Zi,s.tO,s.Dq,s.wI,s.W2,s.IJ,s.W4,s.Gu,s.gu,s.pK,s.Nd,s.VI,s.PQ,s.wd,s.sr,s.ki,s.j9]}),c})()}];let y=(()=>{var r;class c{}return(r=c).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[m.Bz.forChild(Z),m.Bz]}),c})(),C=(()=>{var r;class c{}return(r=c).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.ez,g.u5,s.Pc,y]}),c})()}}]);